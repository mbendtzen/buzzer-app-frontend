<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Player Dashboard - Get in the Game Show</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
@keyframes quickFlash {
0% { opacity: 0; transform: scale(0.2); }
35% { opacity: 1; transform: scale(1.1); }
100% { opacity: 0; transform: scale(0.5); }
}

@keyframes buzzer-pulse {
0%, 100% { 
transform: translateY(0px) scale(1); 
box-shadow: 0 15px 35px rgba(0,0,0,0.4), 0 0 30px rgba(234, 179, 8, 0.6), inset 0 -8px 0 rgba(0,0,0,0.2);
}
50% { 
transform: translateY(-3px) scale(1.01); 
box-shadow: 0 20px 40px rgba(0,0,0,0.5), 0 0 40px rgba(234, 179, 8, 0.8), inset 0 -8px 0 rgba(0,0,0,0.2);
}
}

@keyframes buzzer-press {
0% { transform: translateY(0px) scale(1); }
100% { transform: translateY(8px) scale(0.98); }
}

@keyframes confetti-fall {
0% { opacity: 1; transform: translateY(-100vh) rotate(0deg); }
100% { opacity: 0; transform: translateY(100vh) rotate(720deg); }
}

@keyframes cheer-float {
0% { opacity: 1; transform: translateY(0px) scale(1); }
100% { opacity: 0; transform: translateY(-100px) scale(1.2); }
}

@keyframes glassmorphism-pulse {
0%, 100% { backdrop-filter: blur(16px); background: rgba(147, 51, 234, 0.1); }
50% { backdrop-filter: blur(20px); background: rgba(147, 51, 234, 0.15); }
}

.sparkle {
animation: quickFlash 0.25s ease-out;
pointer-events: none;
}

.logo-glow {
filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
}

.buzzer-normal {
transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
transform: translateY(0px) scale(1);
box-shadow: 
0 15px 35px rgba(0,0,0,0.4),
inset 0 -8px 0 rgba(0,0,0,0.2),
inset 0 1px 0 rgba(255,255,255,0.1),
0 0 30px rgba(234, 179, 8, 0.6);
animation: buzzer-pulse 2s ease-in-out infinite;
}

.buzzer-hover {
transform: translateY(-4px) scale(1.02);
box-shadow:
0 25px 50px rgba(0,0,0,0.6),
inset 0 -8px 0 rgba(0,0,0,0.2),
inset 0 1px 0 rgba(255,255,255,0.2),
0 0 40px rgba(234, 179, 8, 0.8);
}

.buzzer-active {
animation: buzzer-press 0.1s ease-out;
}

.buzzer-buzzed {
background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%) !important;
animation: none;
transform: translateY(8px) scale(0.98);
box-shadow: 
0 8px 20px rgba(0,0,0,0.4),
inset 0 2px 0 rgba(255,255,255,0.2);
}

.glassmorphism {
backdrop-filter: blur(16px) saturate(180%);
background: rgba(147, 51, 234, 0.1);
border: 1px solid rgba(255, 255, 255, 0.125);
animation: glassmorphism-pulse 4s ease-in-out infinite;
}

.input-sleek {
backdrop-filter: blur(16px);
background: rgba(147, 51, 234, 0.15);
box-shadow: 
0 8px 32px rgba(0, 0, 0, 0.15),
inset 0 1px 0 rgba(255, 255, 255, 0.1),
0 0 0 1px rgba(255, 255, 255, 0.05);
transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.input-sleek:focus {
background: rgba(147, 51, 234, 0.2);
box-shadow: 
0 12px 40px rgba(0, 0, 0, 0.2),
inset 0 1px 0 rgba(255, 255, 255, 0.15),
0 0 0 2px rgba(20, 184, 166, 0.5);
}

.button-consistent {
border: 3px solid;
font-weight: bold;
padding: 0.5rem 0.75rem;
border-radius: 0.5rem;
transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
transform: scale(1);
}

.button-consistent:hover {
transform: scale(0.95) translateY(-1px);
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
}

.confetti {
position: fixed;
font-size: 20px;
animation: confetti-fall 4s linear;
pointer-events: none;
z-index: 1000;
}

.cheer-emoji {
position: absolute;
font-size: 24px;
animation: cheer-float 4s ease-out forwards;
pointer-events: none;
z-index: 100;
}

body {
background: linear-gradient(135deg, #1e3a8a 0%, #312e81 50%, #1e1b4b 100%);
margin: 0;
font-family: 'Inter', system-ui, -apple-system, sans-serif;
min-height: 100vh;
}
</style>
</head>
<body>
<div id="app" class="relative min-h-screen overflow-hidden">
<!-- Sparkles Container -->
<div id="sparkles"></div>

<!-- Confetti Container -->
<div id="confetti-container"></div>

<!-- Entry Screen -->
<div id="entryScreen" class="min-h-screen flex flex-col items-center justify-center p-6">
<!-- Logo -->
<div class="mb-12 text-center">
<img
src="logo.png"
alt="Get in the Game Show Logo"
class="logo-glow w-32 h-32 mx-auto mb-4 rounded-2xl shadow-2xl"
onerror="this.style.display='none'"
/>
<div class="text-white text-2xl font-bold mb-2">‚ö° GET EXCITED ‚ö°</div>
<div class="text-purple-200 text-lg">Ready to play?</div>

<!-- Game Code Entry -->
<div class="w-full max-w-sm space-y-6">
<div class="relative">
<input
type="text"
id="gameCodeInput"
class="input-sleek w-full h-16 text-center text-3xl font-bold text-white border-4 border-cyan-400 rounded-2xl shadow-2xl placeholder-gray-300 focus:outline-none focus:ring-4 focus:ring-cyan-400 transition-all font-mono tracking-wider"
placeholder="Enter 6-digit code"
maxlength="6"
/>
</div>

<button
id="joinGameBtn"
class="w-full h-16 text-2xl font-bold rounded-2xl border-4 border-yellow-400 shadow-2xl transition-all transform bg-gray-600 text-gray-300 cursor-not-allowed opacity-50"
disabled
>
‚≠êÔ∏è JOIN GAME ‚≠êÔ∏è
</button>
</div>
</div>

<!-- Team Setup Screen -->
<div id="teamSetupScreen" class="min-h-screen flex-col items-center justify-center p-6" style="display: none;">
<!-- Logo -->
<div class="mb-8 text-center">
<img
src="logo.png"
alt="Get in the Game Show Logo"
class="logo-glow w-24 h-24 mx-auto mb-2 rounded-xl shadow-xl"
  onerror="this.style.display='none'"
/>
<div class="text-white text-xl font-bold">üë• Team Setup</div>
</div>

<!-- Team Name Entry -->
<div class="w-full max-w-sm space-y-6">
<div>
<input
type="text"
id="teamNameInput"
class="input-sleek w-full h-16 text-center text-2xl font-bold text-white border-4 border-cyan-400 rounded-2xl shadow-2xl placeholder-gray-300 focus:outline-none focus:ring-4 focus:ring-cyan-400 transition-all"
placeholder="Enter Team Name"
maxlength="40"
/>
<div class="text-right text-purple-200 text-sm mt-2">
<span id="charCount">0</span>/40 characters
</div>
</div>

<button
id="submitTeamBtn"
class="w-full h-16 text-2xl font-bold rounded-2xl border-4 border-yellow-400 shadow-2xl transition-all transform bg-gray-600 text-gray-300 cursor-not-allowed opacity-50"
disabled
>
üöÄ LET'S PLAY! üöÄ
</button>
</div>
</div>

<!-- Dashboard Screen -->
<div id="dashboardScreen" class="min-h-screen flex-col p-6" style="display: none;">
<!-- Header -->
<div class="text-center mb-6">
<img
src="logo.png"
  alt="Get in the Game Show Logo"
class="logo-glow w-20 h-20 mx-auto mb-2 rounded-xl shadow-xl"
  onerror="this.style.display='none'"
/>
<h1 class="text-2xl font-bold text-white">‚ö° TEAM DASHBOARD ‚ö°</h1>
</div>

<!-- Team Info Box -->
<div class="glassmorphism bg-gradient-to-r from-purple-700 to-purple-800 border-4 border-yellow-400 rounded-2xl p-4 mb-6 shadow-2xl">
<div class="text-center">
<div class="text-yellow-400 text-sm font-bold mb-1">TEAM</div>
<h2 id="teamNameDisplay" class="text-xl font-bold text-white mb-1">‚≠êÔ∏è Team Name ‚≠êÔ∏è</h2>
<p class="text-white text-lg mb-3 font-bold">are here to PLAY! ü•≥</p>
<div class="flex space-x-3">
<button
id="cheerBtn"
class="button-consistent flex-1 bg-gradient-to-r from-blue-600 to-blue-700 text-white border-blue-400 hover:from-blue-500 hover:to-blue-600 shadow-lg text-sm"
>
üéâ CHEER üéâ
</button>
<button
id="exitGameBtn"
class="button-consistent flex-1 text-white shadow-lg text-sm border-pink-300"
style="background: linear-gradient(to right, #cb0cea, #cb0cea); border-color: #f9a8d4;"
>
üö™ EXIT
</button>
</div>
</div>
</div>

<!-- Giant 3D Buzzer Button -->
<div id="buzzerContainer" class="flex-1 flex items-center justify-center mb-8">
<button
id="buzzerBtn"
class="buzzer-normal w-80 h-80 rounded-full text-center font-bold bg-gradient-to-b from-yellow-400 via-yellow-500 to-yellow-600 text-blue-900 relative"
>
<div class="flex flex-col items-center justify-center h-full relative z-10">
<div class="text-xl leading-tight mb-1 font-black">GET READY TO</div>
<div class="text-xl leading-tight mb-3 font-black">GET IN THE GAME!</div>
<div class="text-5xl mb-2">üö®</div>
<div class="text-2xl font-black">TAP TO BUZZ!</div>
</div>
<!-- 3D Button Effect Rings -->
<div class="absolute inset-2 rounded-full bg-gradient-to-b from-yellow-300 to-yellow-400 opacity-30"></div>
<div class="absolute inset-4 rounded-full bg-gradient-to-b from-yellow-200 to-yellow-300 opacity-20"></div>
</button>
</div>

<!-- Bottom Message -->
<div id="qrMessage" class="text-center glassmorphism bg-gradient-to-r from-purple-700 to-purple-800 border-4 border-cyan-400 rounded-2xl p-4 shadow-lg" style="box-shadow: 0 0 15px rgba(20, 184, 166, 0.3);">
<div class="text-purple-100 text-sm leading-relaxed">
üíé <strong>Scan QR code on the scoresheet to join our Frequent Fun Program and earn rewards just for playing!</strong> üíé
</div>
</div>

<!-- Celebration Screen (Hidden) -->
<div id="celebrationScreen" class="text-center" style="display: none;">
<div class="glassmorphism bg-gradient-to-r from-purple-700 to-purple-800 border-4 border-yellow-400 rounded-2xl p-6 shadow-2xl">
<div id="placeDisplay" class="text-4xl font-bold text-white mb-4">üèÜ You got 1st place! üèÜ</div>
<div class="text-2xl font-bold text-cyan-400 mb-6">You just earned 1000 sMiles! ü§©</div>
<div class="text-lg text-purple-100 leading-relaxed">
<strong>Scan QR code on scoresheet to join Frequent Fun Program and earn your first gift instantly! üéÅ</strong>
</div>
</div>
</div>
</div>
</div>

<script>
// Initialize Supabase
const supabaseUrl = 'https://tqpuxtswcuwruaqhompl.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxcHV4dHN3Y3V3cnVhcWhvbXBsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc1NDUyMjQsImV4cCI6MjA3MzEyMTIyNH0.JF71Ap_FJG872iApuXaKW-vNN5TWPiJXvmz6PXWm4cU';
const supabase = window.supabase.createClient(supabaseUrl, supabaseKey, {
  global: {
    headers: {
      'Accept': 'application/json',
      'Content-Type': 'application/json'
    }
  }
});
// Game state
let currentScreen = 'entry';
let gameCode = '';
let teamName = '';
let teamId = null;
let gameId = null;
let isBuzzed = false;
let realtimeChannel = null;

// Enhanced sparkle effect
function createSparkle() {
const shapes = ['‚ú¶', '‚Ä¢', '¬∑', '*', '‚úß', '‚ãÜ', '‚ó¶'];
const sparklesContainer = document.getElementById('sparkles');
for(let i = 0; i < 3; i++) {
setTimeout(() => {
const sparkle = document.createElement('div');
sparkle.className = 'sparkle';
sparkle.style.position = 'absolute';
sparkle.style.left = (Math.random() * 90 + 5) + '%';
sparkle.style.top = (Math.random() * 90 + 5) + '%';
sparkle.style.color = 'white';
sparkle.style.fontSize = (Math.random() < 0.4 ? 6 : Math.random() < 0.7 ? 10 : 14) + 'px';
sparkle.style.textShadow = '0 0 4px rgba(255,255,255,0.8)';
sparkle.textContent = shapes[Math.floor(Math.random() * shapes.length)];
sparkle.style.zIndex = '5';
sparklesContainer.appendChild(sparkle);
setTimeout(() => sparkle.remove(), 250);
}, i * 50);
}
}
setInterval(createSparkle, 100);

// Confetti effect
function createConfetti() {
const colors = ['üéâ', 'üéä', '‚≠ê', '‚ú®', 'üåü', 'üí´'];
for (let i = 0; i < 50; i++) {
setTimeout(() => {
const confetti = document.createElement('div');
confetti.className = 'confetti';
confetti.style.left = Math.random() * 100 + '%';
confetti.style.animationDelay = Math.random() * 2 + 's';
confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
confetti.textContent = colors[Math.floor(Math.random() * colors.length)];
document.getElementById('confetti-container').appendChild(confetti);
setTimeout(() => confetti.remove(), 6000);
}, i * 100);
}
}

// Cheer animation
function createCheerAnimation() {
const cheerEmojis = ['üéâ', 'üéä', 'ü•≥', '‚ú®', 'üåü', 'üí´', 'üéà'];
const cheerContainer = document.getElementById('buzzerContainer');

for (let i = 0; i < 12; i++) {
setTimeout(() => {
const cheerEmoji = document.createElement('div');
cheerEmoji.className = 'cheer-emoji';
cheerEmoji.style.left = (Math.random() * 80 + 10) + '%';
cheerEmoji.style.bottom = '0px';
cheerEmoji.textContent = cheerEmojis[Math.floor(Math.random() * cheerEmojis.length)];
cheerContainer.appendChild(cheerEmoji);
setTimeout(() => cheerEmoji.remove(), 4000);
}, i * 200);
}
}

// Screen management
function showScreen(screen) {
document.getElementById('entryScreen').style.display = 'none';
document.getElementById('teamSetupScreen').style.display = 'none';
document.getElementById('dashboardScreen').style.display = 'none';

if (screen === 'entry') {
document.getElementById('entryScreen').style.display = 'flex';
} else if (screen === 'teamSetup') {
document.getElementById('teamSetupScreen').style.display = 'flex';
} else if (screen === 'dashboard') {
document.getElementById('dashboardScreen').style.display = 'flex';
}
currentScreen = screen;
}

// Supabase functions
async function validateGameCode(code) {
const { data, error } = await supabase
.from('games')
.select('id')
.eq('game_code', code)
.eq('status', 'active')
.single();

if (error || !data) {
return null;
}
return data.id;
}

async function joinGame(code, name) {
const validGameId = await validateGameCode(code);
if (!validGameId) {
alert('Invalid game code or game not active!');
return false;
}

const { data: existingTeam } = await supabase
.from('teams')
.select('id')
.eq('game_id', validGameId)
.eq('name', name)
.single();

if (existingTeam) {
alert('Team name already taken in this game!');
return false;
}

const { data, error } = await supabase
.from('teams')
.insert([{
game_id: validGameId,
name: name,
created_at: new Date().toISOString()
}])
.select()
.single();

if (error) {
console.error('Error joining game:', error);
alert('Error joining game. Please try again.');
return false;
}

gameId = validGameId;
teamId = data.id;
setupRealtime();
return true;
}

async function buzzIn() {
if (!teamId || isBuzzed) return false;

const { error } = await supabase
.from('teams')
.update({
buzzed_at: new Date().toISOString()
})
.eq('id', teamId);

if (error) {
console.error('Error buzzing in:', error);
return false;
}
return true;
}

// Setup real-time subscriptions
function setupRealtime() {
if (realtimeChannel) {
supabase.removeChannel(realtimeChannel);
}
realtimeChannel = supabase
.channel(`team_${teamId}`)
.on('postgres_changes',
{ event: 'UPDATE', schema: 'public', table: 'teams', filter: `id=eq.${teamId}` },
(payload) => {
console.log('Team update:', payload);
if (payload.new.buzzed_at === null && isBuzzed) {
// Buzzer was cleared
resetBuzzer();
}
if (payload.new.score !== null && payload.new.score !== undefined) {
// Score was revealed
showCelebration(payload.new.score);
}
}
)
.on('postgres_changes',
{ event: 'UPDATE', schema: 'public', table: 'games', filter: `id=eq.${gameId}` },
(payload) => {
if (payload.new.status === 'ended') {
// Game ended
alert('Game has ended by the host.');
exitGame();
}
}
)
.subscribe();
}

function resetBuzzer() {
isBuzzed = false;
const buzzer = document.getElementById('buzzerBtn');
buzzer.className = 'buzzer-normal w-80 h-80 rounded-full text-center font-bold bg-gradient-to-b from-yellow-400 via-yellow-500 to-yellow-600 text-blue-900 relative';
buzzer.innerHTML = `
<div class="flex flex-col items-center justify-center h-full relative z-10">
<div class="text-xl leading-tight mb-1 font-black">GET READY TO</div>
<div class="text-xl leading-tight mb-3 font-black">GET IN THE GAME!</div>
<div class="text-5xl mb-2">üö®</div>
<div class="text-2xl font-black">TAP TO BUZZ!</div>
</div>
<div class="absolute inset-2 rounded-full bg-gradient-to-b from-yellow-300 to-yellow-400 opacity-30"></div>
<div class="absolute inset-4 rounded-full bg-gradient-to-b from-yellow-200 to-yellow-300 opacity-20"></div>
`;
}

// Calculate place and show celebration
function calculatePlace(score, allScores) {
const sortedScores = [...new Set(allScores)].sort((a, b) => a - b);
const place = sortedScores.indexOf(score) + 1;
const teamsWithSameScore = allScores.filter(s => s === score).length;
return { place, isTie: teamsWithSameScore > 1 };
}

async function showCelebration(teamScore) {
// Get all team scores for place calculation
const { data: teams } = await supabase
.from('teams')
.select('score')
.eq('game_id', gameId)
.not('score', 'is', null);

const allScores = teams.map(t => t.score);
const { place, isTie } = calculatePlace(teamScore, allScores);

// Hide buzzer and QR message
document.getElementById('buzzerContainer').style.display = 'none';
document.getElementById('qrMessage').style.display = 'none';

// Show celebration
const celebrationScreen = document.getElementById('celebrationScreen');
const placeDisplay = document.getElementById('placeDisplay');

const placeText = getPlaceSuffix(place);
if (isTie) {
placeDisplay.innerHTML = `üéâ It's a Tie! You Got ${place}${placeText} Place! üéâ`;
} else {
placeDisplay.innerHTML = `üèÜ You got ${place}${placeText} place! üèÜ`;
}

celebrationScreen.style.display = 'block';

// Start continuous confetti
const confettiInterval = setInterval(createConfetti, 3000);
createConfetti();

// Play fanfare once
try {
new Audio('fanfare.mp3').play().catch(() => {});
} catch (e) {}

// Store interval so it can be cleared on exit
window.confettiInterval = confettiInterval;
}

function getPlaceSuffix(place) {
if (place % 10 === 1 && place !== 11) return 'st';
if (place % 10 === 2 && place !== 12) return 'nd';
if (place % 10 === 3 && place !== 13) return 'rd';
return 'th';
}

function exitGame() {
// Clear confetti
if (window.confettiInterval) {
clearInterval(window.confettiInterval);
}

// Clean up realtime
if (realtimeChannel) {
supabase.removeChannel(realtimeChannel);
}

// Reset state
gameCode = '';
teamName = '';
teamId = null;
gameId = null;
isBuzzed = false;

// Reset UI
document.getElementById('gameCodeInput').value = '';
document.getElementById('teamNameInput').value = '';
document.getElementById('charCount').textContent = '0';
document.getElementById('buzzerContainer').style.display = 'flex';
document.getElementById('qrMessage').style.display = 'block';
document.getElementById('celebrationScreen').style.display = 'none';

resetBuzzer();
showScreen('entry');
}

// Game code validation
function isValidGameCodeFormat(code) {
return /^\d{6}$/.test(code);
}

// Game code input with validation
document.getElementById('gameCodeInput').addEventListener('input', async function(e) {
let value = e.target.value.replace(/\D/g, '').slice(0, 6);
e.target.value = value;
gameCode = value;

const joinBtn = document.getElementById('joinGameBtn');

if (value.length === 6 && isValidGameCodeFormat(value)) {
// Validate game code exists
const validGameId = await validateGameCode(value);
if (validGameId) {
joinBtn.disabled = false;
joinBtn.className = 'w-full h-16 text-2xl font-bold rounded-2xl border-4 border-yellow-400 shadow-2xl transition-all transform bg-cyan-400 text-blue-900 button-consistent';
} else {
joinBtn.disabled = true;
joinBtn.className = 'w-full h-16 text-2xl font-bold rounded-2xl border-4 border-yellow-400 shadow-2xl transition-all transform bg-red-600 text-white cursor-not-allowed opacity-75';
joinBtn.textContent = '‚ùå INVALID CODE ‚ùå';
setTimeout(() => {
joinBtn.textContent = '‚≠êÔ∏è JOIN GAME ‚≠êÔ∏è';
joinBtn.className = 'w-full h-16 text-2xl font-bold rounded-2xl border-4 border-yellow-400 shadow-2xl transition-all transform bg-gray-600 text-gray-300 cursor-not-allowed opacity-50';
}, 2000);
}
} else {
joinBtn.disabled = true;
joinBtn.className = 'w-full h-16 text-2xl font-bold rounded-2xl border-4 border-yellow-400 shadow-2xl transition-all transform bg-gray-600 text-gray-300 cursor-not-allowed opacity-50';
joinBtn.textContent = '‚≠êÔ∏è JOIN GAME ‚≠êÔ∏è';
}
});

// Join game
document.getElementById('joinGameBtn').addEventListener('click', function() {
if (gameCode.length === 6 && isValidGameCodeFormat(gameCode)) {
showScreen('teamSetup');
}
});

// Team name input
document.getElementById('teamNameInput').addEventListener('input', function(e) {
const value = e.target.value.slice(0, 40);
e.target.value = value;
teamName = value;
document.getElementById('charCount').textContent = value.length;

const submitBtn = document.getElementById('submitTeamBtn');
if (value.trim().length >= 2) {
submitBtn.disabled = false;
submitBtn.className = 'w-full h-16 text-2xl font-bold rounded-2xl border-4 border-yellow-400 shadow-2xl transition-all transform bg-cyan-400 text-blue-900 button-consistent';
} else {
submitBtn.disabled = true;
submitBtn.className = 'w-full h-16 text-2xl font-bold rounded-2xl border-4 border-yellow-400 shadow-2xl transition-all transform bg-gray-600 text-gray-300 cursor-not-allowed opacity-50';
}
});

// Submit team
document.getElementById('submitTeamBtn').addEventListener('click', async function() {
if (teamName.trim().length >= 2) {
const success = await joinGame(gameCode, teamName.trim());
if (success) {
document.getElementById('teamNameDisplay').textContent = `‚≠êÔ∏è ${teamName} ‚≠êÔ∏è`;
showScreen('dashboard');
}
}
});

// Epic buzzer functionality
const buzzerBtn = document.getElementById('buzzerBtn');

buzzerBtn.addEventListener('mouseenter', function() {
if (!isBuzzed) {
this.classList.remove('buzzer-normal');
this.classList.add('buzzer-hover');
}
});

buzzerBtn.addEventListener('mouseleave', function() {
if (!isBuzzed) {
this.classList.remove('buzzer-hover');
this.classList.add('buzzer-normal');
}
});

buzzerBtn.addEventListener('mousedown', function() {
if (!isBuzzed) {
this.classList.add('buzzer-active');
}
});

buzzerBtn.addEventListener('mouseup', function() {
this.classList.remove('buzzer-active');
});

buzzerBtn.addEventListener('click', async function() {
if (!isBuzzed) {
const success = await buzzIn();
if (success) {
isBuzzed = true;

// Transform buzzer to "buzzed in" state
this.className = 'w-80 h-80 rounded-full text-center font-bold text-white buzzer-buzzed relative';
this.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%)';
this.innerHTML = `
<div class="flex flex-col items-center justify-center h-full relative z-10">
<div class="text-3xl mb-3">üî• YOU'RE IN! üî•</div>
<div class="text-lg leading-tight mb-2">WAIT FOR HOST</div>
<div class="text-lg leading-tight">TO CALL ON YOU</div>
<div class="text-4xl mt-3 animate-pulse">‚ö°</div>
</div>
<div class="absolute inset-2 rounded-full bg-gradient-to-b from-green-400 to-green-500 opacity-30"></div>
<div class="absolute inset-4 rounded-full bg-gradient-to-b from-green-300 to-green-400 opacity-20"></div>
`;

// Add success vibration
if ('vibrate' in navigator) {
navigator.vibrate([100, 50, 100]);
}

// Play buzz sound
try {
new Audio('buzzer.mp3').play().catch(() => {});
} catch (e) {}

// Create celebration effect
for (let i = 0; i < 15; i++) {
setTimeout(() => {
const celebration = document.createElement('div');
celebration.style.position = 'absolute';
celebration.style.left = (Math.random() * 100) + '%';
celebration.style.top = (Math.random() * 100) + '%';
celebration.style.fontSize = '24px';
celebration.style.zIndex = '20';
celebration.style.animation = 'quickFlash 0.5s ease-out';
celebration.style.pointerEvents = 'none';
celebration.textContent = ['üéâ', 'üéä', '‚ö°', 'üî•', 'üåü', 'üí•'][Math.floor(Math.random() * 6)];
document.body.appendChild(celebration);
setTimeout(() => celebration.remove(), 500);
}, i * 100);
}
}
}
});

// Cheer button functionality
document.getElementById('cheerBtn').addEventListener('click', function() {
createCheerAnimation();
try {
new Audio('clapping.mp3').play().catch(() => {});
} catch (e) {}
});

// Exit game functionality
document.getElementById('exitGameBtn').addEventListener('click', function() {
if (confirm('Are you sure you want to leave the game?')) {
exitGame();
}
});

// Keyboard support
document.addEventListener('keydown', function(e) {
if (currentScreen === 'dashboard' && (e.key === ' ' || e.key === 'Enter')) {
e.preventDefault();
document.getElementById('buzzerBtn').click();
}
});

// Prevent zoom on double tap
let lastTouchEnd = 0;
document.addEventListener('touchend', function (event) {
const now = (new Date()).getTime();
if (now - lastTouchEnd <= 300) {
event.preventDefault();
}
lastTouchEnd = now;
}, false);
</script>
</body>
</html>
